{"version":3,"file":"avatar.min.js","sources":["../src/avatar.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * JavaScript for displaying an avatar.\n *\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n *\n * @copyright 28/03/2022 LdesignMedia.nl - Luuk Verhoeven\n * @author    Vincent Cornelis\n */\n\nimport Log from 'core/log';\n\n/**\n * Initialise.\n *\n * @param {Object} information Avatar information.\n */\nexport const init = (information) => {\n\n    Log.log(information);\n\n    var gifs = Object.values(information.avatargifs);\n\n    Log.log(\"The init function was called\");\n\n    const avatarMoodlenautDiv = document.createElement('div');\n    avatarMoodlenautDiv.style.cssText = 'position:absolute;' +\n        'width:100%;' +\n        'height:200px;' +\n        'z-index:100;' +\n        'overflow:hidden;' +\n        'pointer-events: none;'+\n        'bottom:0';\n    avatarMoodlenautDiv.setAttribute(\"id\", \"avatar-moodlenautspace\");\n    document.getElementById(\"page-wrapper\").appendChild(avatarMoodlenautDiv);\n\n    // THE GOOSE INJECTION\n    var avatars = information.avatars;\n    const avatarMoodlenautContainer = [];\n    for (const [userid, avatar] of Object.entries(avatars)) {\n        var ava = createMoodlenautContainer(gifs[avatar.avatar-1],userid);\n        avatarMoodlenautContainer.push(ava);\n        document.getElementById(\"avatar-moodlenautspace\").appendChild(ava);\n    }\n\n    // MOVE THE GOOSE.\n    for (const [userid, avatar] of Object.entries(avatars)) {\n        Log.log(avatar.fullname);\n        /*\n        const random = Math.floor(Math.random() * 5000);\n        setInterval(() => {\n            document.getElementById(\"avatar-moodlenautContainer\"+userid).style.left = \"110%\";\n        }, random);\n         */\n        let traveltimeLoopDuration = 1000;\n        setInterval(() =>  {\n            traveltimeLoopDuration = avatarMoveAvatarRandomized(\"avatar-moodlenautContainer\"+userid)*1000;\n        }, traveltimeLoopDuration + 1000);\n    }\n\n    /**\n     * Create a avatar with an id and a gif\n     * @param {String} gif gif for the avatar\n     * @param {int} id id for the avatar\n     */\n    function createMoodlenautContainer(gif,id){\n        const avatarMoodlenautContainer = document.createElement('div');\n        avatarMoodlenautContainer.style.cssText = 'position:absolute;' +\n            'width:64px;' +\n            'height:64px;' +\n            'z-index:100;' +\n            'background-image:url(\"'+gif+'\");' +\n            'overflow:hidden;' +\n            'bottom:0px;' +\n            'background-size:cover;';\n        avatarMoodlenautContainer.setAttribute(\"id\", \"avatar-moodlenautContainer\"+id);\n        avatarMoodlenautContainer.style.left = \"-70px\";\n        avatarMoodlenautContainer.style.transition = \"left 20s linear\";\n        return avatarMoodlenautContainer;\n    }\n    /**\n     * Moves an Avatar.\n     * @constructor\n     * @param {string} avatarID - ID of the actual avatar container which should be moved in a random way.\n     * @return (integer) traveltime, the planed duration of the ainmation\n     */\n    function avatarMoveAvatarRandomized(avatarID){\n        var thisAvatar = document.getElementById(avatarID);\n        var thisAvatarRect = thisAvatar.getBoundingClientRect();\n        var thisAvatarLeftPosition = thisAvatarRect.left;\n        var randomizer = Math.random() * 100;\n        var newPositionWalkoutsidemodifier = Math.random() * 160 - 80;\n        var newPosition = randomizer + newPositionWalkoutsidemodifier;\n        var traveltime = randomizer * 0.25 + \"s\";\n        var thisAvatarLeftPositionPercentage = thisAvatarLeftPosition / window.innerWidth * 100;\n\n        /* eslint-disable no-console */\n        console.log(\"Randomizer Values:\" +\n            randomizer +\n            \" New Position: \" +\n            newPosition +\n            \" Traveltime: \" +\n            traveltime +\n            \" Avatarid: \" +\n            avatarID +\n            \" left: \" +\n            thisAvatarLeftPosition +\n            \" Leftpositionpercentage: \" +\n            thisAvatarLeftPositionPercentage +\n            \" outsidemodifier: \" +\n            newPositionWalkoutsidemodifier);\n        /* eslint-enable no-console */\n\n        if(newPosition > thisAvatarLeftPositionPercentage){\n            thisAvatar.style.transform = \"scaleX(1)\";\n        }\n        else if(newPosition < thisAvatarLeftPositionPercentage){\n            thisAvatar.style.transform = \"scaleX(-1)\";\n        }\n        thisAvatar.style.transition = \"left \" +\n            traveltime +\n            \" linear, right \" +\n            traveltime +\n            \" linear\";\n        thisAvatar.style.left = newPosition + \"%\";\n\n        return traveltime;\n    }\n\n\n};\n"],"names":["information","log","gifs","Object","values","avatargifs","avatarMoodlenautDiv","document","createElement","style","cssText","setAttribute","getElementById","appendChild","avatars","avatarMoodlenautContainer","userid","avatar","entries","ava","createMoodlenautContainer","push","fullname","traveltimeLoopDuration","setInterval","avatarMoveAvatarRandomized","gif","id","left","transition","avatarID","thisAvatar","thisAvatarLeftPosition","getBoundingClientRect","randomizer","Math","random","newPositionWalkoutsidemodifier","newPosition","traveltime","thisAvatarLeftPositionPercentage","window","innerWidth","console","transform"],"mappings":";;;;;;;;kJA+BqBA,2BAEbC,IAAID,iBAEJE,KAAOC,OAAOC,OAAOJ,YAAYK,yBAEjCJ,IAAI,sCAEFK,oBAAsBC,SAASC,cAAc,OACnDF,oBAAoBG,MAAMC,QAAU,sGAOpCJ,oBAAoBK,aAAa,KAAM,0BACvCJ,SAASK,eAAe,gBAAgBC,YAAYP,yBAGhDQ,QAAUd,YAAYc,cACpBC,0BAA4B,OAC7B,MAAOC,OAAQC,UAAWd,OAAOe,QAAQJ,SAAU,KAChDK,IAAMC,0BAA0BlB,KAAKe,OAAOA,OAAO,GAAGD,QAC1DD,0BAA0BM,KAAKF,KAC/BZ,SAASK,eAAe,0BAA0BC,YAAYM,SAI7D,MAAOH,OAAQC,UAAWd,OAAOe,QAAQJ,SAAU,cAChDb,IAAIgB,OAAOK,cAOXC,uBAAyB,IAC7BC,aAAY,KACRD,uBAAyF,IAAhEE,2BAA2B,6BAA6BT,UAClFO,uBAAyB,cAQvBH,0BAA0BM,IAAIC,UAC7BZ,0BAA4BR,SAASC,cAAc,cACzDO,0BAA0BN,MAAMC,QAAU,8EAIbgB,IAJa,uDAQ1CX,0BAA0BJ,aAAa,KAAM,6BAA6BgB,IAC1EZ,0BAA0BN,MAAMmB,KAAO,QACvCb,0BAA0BN,MAAMoB,WAAa,kBACtCd,mCAQFU,2BAA2BK,cAC5BC,WAAaxB,SAASK,eAAekB,UAErCE,uBADiBD,WAAWE,wBACYL,KACxCM,WAA6B,IAAhBC,KAAKC,SAClBC,+BAAiD,IAAhBF,KAAKC,SAAiB,GACvDE,YAAcJ,WAAaG,+BAC3BE,WAA0B,IAAbL,WAAoB,IACjCM,iCAAmCR,uBAAyBS,OAAOC,WAAa,WAGpFC,QAAQ1C,IAAI,qBACRiC,WACA,kBACAI,YACA,gBACAC,WACA,cACAT,SACA,UACAE,uBACA,4BACAQ,iCACA,qBACAH,gCAGDC,YAAcE,iCACbT,WAAWtB,MAAMmC,UAAY,YAEzBN,YAAcE,mCAClBT,WAAWtB,MAAMmC,UAAY,cAEjCb,WAAWtB,MAAMoB,WAAa,QAC1BU,WACA,kBACAA,WACA,UACJR,WAAWtB,MAAMmB,KAAOU,YAAc,IAE/BC"}